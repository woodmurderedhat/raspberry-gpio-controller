<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raspberry Pi GPIO Controller Pro - Documentation</title>
    <style>
        :root {
            --primary-color: #2196f3;
            --secondary-color: #1976d2;
            --text-color: #333;
            --code-bg: #f5f5f5;
        }
        
        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        h1, h2, h3 {
            color: var(--primary-color);
            margin-top: 2em;
        }

        .header {
            text-align: center;
            padding: 40px 0;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 8px;
            margin-bottom: 40px;
        }

        .header h1 {
            color: white;
            margin: 0;
        }

        .nav {
            position: sticky;
            top: 20px;
            float: right;
            width: 250px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .nav ul {
            list-style: none;
            padding: 0;
        }

        .nav a {
            color: var(--text-color);
            text-decoration: none;
        }

        .nav a:hover {
            color: var(--primary-color);
        }

        .content {
            margin-right: 300px;
        }

        code {
            background: var(--code-bg);
            padding: 2px 5px;
            border-radius: 3px;
            font-family: 'Consolas', monospace;
        }

        pre {
            background: var(--code-bg);
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: left;
        }

        th {
            background: var(--primary-color);
            color: white;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .feature-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
        }

        .tip {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Raspberry Pi GPIO Controller Pro</h1>
        <p>Complete Documentation</p>
    </div>

    <nav class="nav">
        <h3>Contents</h3>
        <ul>
            <li><a href="#overview">Overview</a></li>
            <li><a href="#installation">Installation</a></li>
            <li><a href="#gpio-control">GPIO Control</a></li>
            <li><a href="#interfaces">Hardware Interfaces</a></li>
            <li><a href="#security">Security Features</a></li>
            <li><a href="#monitoring">System Monitoring</a></li>
            <li><a href="#api">API Reference</a></li>
            <li><a href="#troubleshooting">Troubleshooting</a></li>
            <li><a href="#usage-examples">Usage Examples</a></li>
        </ul>
    </nav>

    <div class="content">
        <section id="overview">
            <h2>Overview</h2>
            <p>The Raspberry Pi GPIO Controller Pro is a professional-grade web application designed for comprehensive control and monitoring of Raspberry Pi GPIO pins. It provides enterprise-level features including user authentication, detailed system monitoring, and advanced pin configuration options.</p>

            <div class="feature-grid">
                <div class="feature-card">
                    <h3>GPIO Control</h3>
                    <ul>
                        <li>Digital Input/Output</li>
                        <li>PWM Control</li>
                        <li>Edge Detection</li>
                        <li>Pull-up/down Resistors</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h3>Advanced Interfaces</h3>
                    <ul>
                        <li>I2C (6 buses)</li>
                        <li>SPI (Multiple buses)</li>
                        <li>UART (5 ports)</li>
                        <li>PCM Audio</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h3>System Monitoring</h3>
                    <ul>
                        <li>Temperature Tracking</li>
                        <li>CPU Usage</li>
                        <li>Memory Utilization</li>
                        <li>Power Management</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="installation">
            <h2>Installation</h2>
            <h3>Prerequisites</h3>
            <ul>
                <li>Raspberry Pi 5 (recommended) or compatible model</li>
                <li>Python 3.x</li>
                <li>Node.js 18.x or later</li>
                <li>SQLite3</li>
            </ul>

            <h3>Step-by-Step Installation</h3>
            <pre><code>git clone https://github.com/woodmurderedhat/raspberry-gpio-controller.git
cd raspberry-gpio-controller
chmod +x install.sh
./install.sh</code></pre>

            <div class="warning">
                <strong>Important:</strong> After installation, change the default admin password immediately!
            </div>
        </section>

        <section id="gpio-control">
            <h2>GPIO Control</h2>
            
            <h3>Pin Reference Guide</h3>
            <table>
                <tr>
                    <th>Pin Number</th>
                    <th>Supported Modes</th>
                    <th>Special Functions</th>
                    <th>Maximum Ratings</th>
                </tr>
                <tr>
                    <td>GPIO 2, 3</td>
                    <td>I2C, GPIO</td>
                    <td>I2C1 (SDA, SCL) with hardware pullup</td>
                    <td>3.3V, 16mA max</td>
                </tr>
                <tr>
                    <td>GPIO 0, 1</td>
                    <td>I2C, GPIO</td>
                    <td>I2C0 (SDA, SCL)</td>
                    <td>3.3V, 16mA max</td>
                </tr>
                <tr>
                    <td>GPIO 4</td>
                    <td>GPIO, PWM</td>
                    <td>Hardware PWM0</td>
                    <td>3.3V, 16mA max</td>
                </tr>
                <tr>
                    <td>GPIO 5, 6</td>
                    <td>GPIO</td>
                    <td>General Purpose</td>
                    <td>3.3V, 16mA max</td>
                </tr>
                <tr>
                    <td>GPIO 7</td>
                    <td>SPI, GPIO</td>
                    <td>SPI0 CE1</td>
                    <td>3.3V, 16mA max</td>
                </tr>
                <tr>
                    <td>GPIO 8, 9, 10, 11</td>
                    <td>SPI, GPIO</td>
                    <td>SPI0 (CE0, MISO, MOSI, SCLK)</td>
                    <td>3.3V, 16mA max</td>
                </tr>
                <tr>
                    <td>GPIO 14, 15</td>
                    <td>UART, GPIO</td>
                    <td>UART0 (TXD, RXD)</td>
                    <td>3.3V, 16mA max</td>
                </tr>
                <tr>
                    <td>GPIO 12, 13</td>
                    <td>PWM, GPIO</td>
                    <td>Hardware PWM1</td>
                    <td>3.3V, 16mA max</td>
                </tr>
                <tr>
                    <td>GPIO 16-27</td>
                    <td>GPIO</td>
                    <td>General Purpose</td>
                    <td>3.3V, 16mA max</td>
                </tr>
                <tr>
                    <td>GPIO 28, 29</td>
                    <td>I2C, GPIO</td>
                    <td>I2C5 (SDA, SCL)</td>
                    <td>3.3V, 16mA max</td>
                </tr>
            </table>

            <h3>Pin Modes In Detail</h3>
            
            <div class="feature-card">
                <h4>GPIO Input Mode</h4>
                <p>Read digital signals from external devices.</p>
                <h5>Configuration Options:</h5>
                <ul>
                    <li><strong>Pull-up Resistor:</strong> Internal 50kΩ resistor to 3.3V</li>
                    <li><strong>Pull-down Resistor:</strong> Internal 50kΩ resistor to ground</li>
                    <li><strong>Neither:</strong> Floating input (use with external pullup/down)</li>
                </ul>
                <h5>Edge Detection:</h5>
                <ul>
                    <li><strong>Rising Edge:</strong> Trigger on low-to-high transition</li>
                    <li><strong>Falling Edge:</strong> Trigger on high-to-low transition</li>
                    <li><strong>Both Edges:</strong> Trigger on any transition</li>
                </ul>
                <pre><code>// Example API call for input configuration
POST /api/pins/4/config
{
    "mode": "IN",
    "pull": "UP",
    "edge": "BOTH"
}</code></pre>
            </div>

            <div class="feature-card">
                <h4>GPIO Output Mode</h4>
                <p>Control external devices with digital signals.</p>
                <h5>Configuration Options:</h5>
                <ul>
                    <li><strong>Drive Strength:</strong>
                        <ul>
                            <li>2mA: Low power, suitable for LEDs</li>
                            <li>4mA: Standard digital signals</li>
                            <li>8mA: Higher current devices</li>
                            <li>16mA: Maximum drive capability</li>
                        </ul>
                    </li>
                    <li><strong>Slew Rate:</strong>
                        <ul>
                            <li>FAST: Quick transitions, may cause EMI</li>
                            <li>SLOW: Reduced EMI, better for sensitive circuits</li>
                        </ul>
                    </li>
                </ul>
                <pre><code>// Example API call for output configuration
POST /api/pins/18/config
{
    "mode": "OUT",
    "drive": "8MA",
    "slew": "FAST"
}</code></pre>
            </div>

            <div class="feature-card">
                <h4>PWM Mode</h4>
                <p>Generate variable duty cycle signals for motor control, LED dimming, etc.</p>
                <h5>Hardware PWM Features:</h5>
                <ul>
                    <li>Frequency Range: 1Hz - 100MHz</li>
                    <li>Resolution: 12-bit (4096 levels)</li>
                    <li>Zero jitter</li>
                    <li>Available on GPIO 4, 12, 13, 18, 19</li>
                </ul>
                <h5>Software PWM Features:</h5>
                <ul>
                    <li>Frequency Range: 1Hz - 10kHz</li>
                    <li>Resolution: 8-bit (256 levels)</li>
                    <li>Available on all GPIO pins</li>
                </ul>
                <pre><code>// Example API call for PWM configuration
POST /api/pins/18/pwm
{
    "frequency": 1000,
    "duty_cycle": 50,
    "mode": "HARDWARE"
}</code></pre>
            </div>

            <h3>Interface Protocols</h3>
            
            <div class="feature-card">
                <h4>I2C Interface</h4>
                <p>Two-wire serial protocol for device communication.</p>
                <h5>Available Buses:</h5>
                <ul>
                    <li><strong>I2C0:</strong> GPIO 0 (SDA), 1 (SCL)</li>
                    <li><strong>I2C1:</strong> GPIO 2 (SDA), 3 (SCL)</li>
                    <li><strong>I2C2:</strong> GPIO 16 (SDA), 17 (SCL)</li>
                    <li><strong>I2C3:</strong> GPIO 4 (SDA), 5 (SCL)</li>
                    <li><strong>I2C4:</strong> GPIO 8 (SDA), 9 (SCL)</li>
                    <li><strong>I2C5:</strong> GPIO 28 (SDA), 29 (SCL)</li>
                </ul>
                <h5>Features:</h5>
                <ul>
                    <li>Speed modes: Standard (100kHz), Fast (400kHz), Fast+ (1MHz)</li>
                    <li>10-bit addressing support</li>
                    <li>Multi-master capability</li>
                    <li>Clock stretching support</li>
                </ul>
                <pre><code>// Example I2C configuration
POST /api/i2c/config
{
    "bus": "I2C1",
    "speed": 400000,
    "address_mode": "7BIT"
}</code></pre>
            </div>

            <div class="feature-card">
                <h4>SPI Interface</h4>
                <p>High-speed synchronous serial interface.</p>
                <h5>Available Buses:</h5>
                <ul>
                    <li><strong>SPI0:</strong>
                        <ul>
                            <li>SCLK: GPIO 11</li>
                            <li>MOSI: GPIO 10</li>
                            <li>MISO: GPIO 9</li>
                            <li>CE0: GPIO 8</li>
                            <li>CE1: GPIO 7</li>
                        </ul>
                    </li>
                    <li><strong>SPI1:</strong>
                        <ul>
                            <li>SCLK: GPIO 21</li>
                            <li>MOSI: GPIO 20</li>
                            <li>MISO: GPIO 19</li>
                            <li>CE0: GPIO 18</li>
                        </ul>
                    </li>
                </ul>
                <h5>Features:</h5>
                <ul>
                    <li>Clock speeds up to 125MHz</li>
                    <li>8/16/32-bit transfers</li>
                    <li>4 SPI modes (0-3)</li>
                    <li>Hardware CS control</li>
                </ul>
                <pre><code>// Example SPI configuration
POST /api/spi/config
{
    "bus": "SPI0",
    "mode": 0,
    "speed": 1000000,
    "bits_per_word": 8
}</code></pre>
            </div>

            <div class="feature-card">
                <h4>UART Interface</h4>
                <p>Asynchronous serial communication.</p>
                <h5>Available Ports:</h5>
                <ul>
                    <li><strong>UART0:</strong> GPIO 14 (TXD), 15 (RXD)</li>
                    <li><strong>UART1:</strong> GPIO 0 (TXD), 1 (RXD)</li>
                    <li><strong>UART2:</strong> GPIO 4 (TXD), 5 (RXD)</li>
                    <li><strong>UART3:</strong> GPIO 8 (TXD), 9 (RXD)</li>
                    <li><strong>UART4:</strong> GPIO 12 (TXD), 13 (RXD)</li>
                </ul>
                <h5>Features:</h5>
                <ul>
                    <li>Baud rates: 50 to 4,000,000</li>
                    <li>5-8 data bits</li>
                    <li>1-2 stop bits</li>
                    <li>Parity: None, Even, Odd</li>
                    <li>Hardware flow control (RTS/CTS)</li>
                </ul>
                <pre><code>// Example UART configuration
POST /api/uart/config
{
    "port": "UART0",
    "baud": 115200,
    "data_bits": 8,
    "stop_bits": 1,
    "parity": "NONE",
    "flow_control": false
}</code></pre>
            </div>

            <h3>System Monitoring Features</h3>
            
            <div class="feature-card">
                <h4>Temperature Monitoring</h4>
                <p>Track CPU and GPU temperatures.</p>
                <h5>Features:</h5>
                <ul>
                    <li>Real-time temperature readings</li>
                    <li>Historical temperature graphs</li>
                    <li>Configurable warning thresholds</li>
                    <li>Automatic throttling detection</li>
                </ul>
                <pre><code>// Example temperature endpoint
GET /api/system/temperature
{
    "cpu_temp": 45.2,
    "gpu_temp": 42.8,
    "throttled": false
}</code></pre>
            </div>

            <div class="feature-card">
                <h4>Power Management</h4>
                <p>Monitor voltage and current consumption.</p>
                <h5>Monitored Values:</h5>
                <ul>
                    <li>Core voltage (0.8V-1.4V)</li>
                    <li>SDRAM voltage</li>
                    <li>5V rail voltage</li>
                    <li>3.3V rail voltage</li>
                    <li>Current consumption</li>
                </ul>
                <pre><code>// Example power monitoring
GET /api/system/power
{
    "core_voltage": 1.2,
    "sdram_voltage": 1.1,
    "current_ma": 350
}</code></pre>
            </div>

            <div class="feature-card">
                <h4>Performance Monitoring</h4>
                <p>Track system performance metrics.</p>
                <h5>Monitored Metrics:</h5>
                <ul>
                    <li>CPU frequency and usage</li>
                    <li>Memory usage and allocation</li>
                    <li>Disk I/O</li>
                    <li>Network utilization</li>
                </ul>
                <pre><code>// Example performance metrics
GET /api/system/performance
{
    "cpu_freq": 1500,
    "cpu_usage": 25.5,
    "memory_used": 512,
    "memory_total": 4096
}</code></pre>
            </div>
        </section>

        <section id="interfaces">
            <h2>Hardware Interfaces</h2>
            <h3>I2C Configuration</h3>
            <p>The Raspberry Pi 5 supports 6 I2C buses, each configurable through the web interface:</p>
            <ul>
                <li>Bus speed configuration</li>
                <li>Device scanning</li>
                <li>Register read/write</li>
                <li>Multi-master support</li>
            </ul>

            <h3>SPI Interface</h3>
            <p>Multiple SPI buses with configurable:</p>
            <ul>
                <li>Clock speed</li>
                <li>Mode (0-3)</li>
                <li>Chip select polarity</li>
                <li>LSB/MSB first</li>
            </ul>

            <h3>UART Configuration</h3>
            <p>5 UART ports with support for:</p>
            <ul>
                <li>Baud rate selection</li>
                <li>Flow control</li>
                <li>Parity settings</li>
                <li>Stop bits configuration</li>
            </ul>
        </section>

        <section id="security">
            <h2>Security Features</h2>
            <h3>Authentication</h3>
            <ul>
                <li>JWT-based authentication</li>
                <li>Role-based access control</li>
                <li>API key management</li>
                <li>Password hashing with Werkzeug</li>
            </ul>

            <h3>Audit Logging</h3>
            <p>Comprehensive logging of:</p>
            <ul>
                <li>Pin state changes</li>
                <li>Configuration modifications</li>
                <li>User actions</li>
                <li>System events</li>
            </ul>

            <div class="tip">
                <strong>Best Practice:</strong> Rotate API keys regularly and limit admin access to trusted users only.
            </div>
        </section>

        <section id="monitoring">
            <h2>System Monitoring</h2>
            <h3>Real-time Metrics</h3>
            <ul>
                <li>CPU temperature and frequency</li>
                <li>Memory usage and allocation</li>
                <li>Voltage readings</li>
                <li>Power consumption</li>
            </ul>

            <h3>Alerts and Notifications</h3>
            <p>Configure alerts for:</p>
            <ul>
                <li>Temperature thresholds</li>
                <li>Voltage warnings</li>
                <li>CPU throttling</li>
                <li>Memory pressure</li>
            </ul>
        </section>

        <section id="api">
            <h2>API Reference</h2>
            <h3>REST Endpoints</h3>
            <table>
                <tr>
                    <th>Endpoint</th>
                    <th>Method</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>/api/pins</td>
                    <td>GET</td>
                    <td>List all pins and their states</td>
                </tr>
                <tr>
                    <td>/api/pins/&lt;pin&gt;</td>
                    <td>POST</td>
                    <td>Control specific pin</td>
                </tr>
                <tr>
                    <td>/api/system/info</td>
                    <td>GET</td>
                    <td>System information</td>
                </tr>
                <tr>
                    <td>/api/presets</td>
                    <td>POST</td>
                    <td>Save pin configuration preset</td>
                </tr>
            </table>

            <h3>WebSocket Events</h3>
            <pre><code>// Listen for pin state changes
socket.on('pin_state_change', data => {
    console.log('Pin state changed:', data);
});

// Listen for system metrics
socket.on('system_metrics', data => {
    console.log('System update:', data);
});</code></pre>
        </section>

        <section id="troubleshooting">
            <h2>Troubleshooting</h2>
            <h3>Common Issues</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>Permission Errors</h4>
                    <pre><code>sudo usermod -a -G gpio $USER</code></pre>
                    <p>Add user to gpio group and restart.</p>
                </div>
                <div class="feature-card">
                    <h4>Connection Issues</h4>
                    <ul>
                        <li>Check backend status</li>
                        <li>Verify network settings</li>
                        <li>Check firewall rules</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <h4>Database Reset</h4>
                    <pre><code>rm instance/gpio_controller.db
python app.py</code></pre>
                </div>
            </div>

            <div class="warning">
                <strong>Note:</strong> Always backup your configuration before performing any reset operations.
            </div>
        </section>

        <section id="usage-examples">
            <h2>Usage Examples</h2>

            <div class="feature-card">
                <h4>LED Control Example</h4>
                <pre><code>// Configure GPIO18 for LED
POST /api/pins/18/config
{
    "mode": "OUT",
    "drive": "4MA",
    "initial": "LOW"
}

// Turn LED on
POST /api/pins/18
{
    "action": "HIGH"
}

// PWM dimming
POST /api/pins/18/pwm
{
    "frequency": 1000,
    "duty_cycle": 50
}</code></pre>
            </div>

            <div class="feature-card">
                <h4>Button Input Example</h4>
                <pre><code>// Configure GPIO4 for button
POST /api/pins/4/config
{
    "mode": "IN",
    "pull": "UP",
    "edge": "FALLING"
}

// WebSocket event for button press
socket.on('pin_state_change', data => {
    if (data.pin === 4 && data.edge === 'FALLING') {
        console.log('Button pressed!');
    }
});</code></pre>
            </div>

            <div class="feature-card">
                <h4>I2C Sensor Example</h4>
                <pre><code>// Configure I2C bus
POST /api/i2c/config
{
    "bus": "I2C1",
    "speed": 400000
}

// Read from sensor
POST /api/i2c/read
{
    "address": "0x48",
    "register": "0x00",
    "length": 2
}</code></pre>
            </div>

            <div class="feature-card">
                <h4>Motor Control Example</h4>
                <pre><code>// Configure PWM for motor
POST /api/pins/12/pwm
{
    "frequency": 20000,
    "duty_cycle": 0,
    "mode": "HARDWARE"
}

// Set motor speed (0-100%)
POST /api/pins/12/pwm
{
    "duty_cycle": 75
}</code></pre>
            </div>
        </section>
    </div>
</body>
</html>
